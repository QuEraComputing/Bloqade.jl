<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Working with Subspace · Bloqade.jl</title><meta name="title" content="Working with Subspace · Bloqade.jl"/><meta property="og:title" content="Working with Subspace · Bloqade.jl"/><meta property="twitter:title" content="Working with Subspace · Bloqade.jl"/><meta name="description" content="Documentation for Bloqade.jl."/><meta property="og:description" content="Documentation for Bloqade.jl."/><meta property="twitter:description" content="Documentation for Bloqade.jl."/><meta property="og:url" content="https://QuEraComputing.github.io/Bloqade.jl/subspace/"/><meta property="twitter:url" content="https://QuEraComputing.github.io/Bloqade.jl/subspace/"/><link rel="canonical" href="https://QuEraComputing.github.io/Bloqade.jl/subspace/"/><script async src="https://www.googletagmanager.com/gtag/js?id=G-SRKGL6MJHS"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-SRKGL6MJHS', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.svg" alt="Bloqade.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.svg" alt="Bloqade.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../install/">Installation</a></li><li><a class="tocitem" href="../julia/">The Julia Programming Language</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../lattices/">Lattices</a></li><li><a class="tocitem" href="../waveform/">Waveforms</a></li><li><a class="tocitem" href="../hamiltonians/">Hamiltonians</a></li><li><a class="tocitem" href="../registers/">Registers and Observables</a></li><li><a class="tocitem" href="../emulation/">Emulation</a></li><li class="is-active"><a class="tocitem" href>Working with Subspace</a><ul class="internal"><li><a class="tocitem" href="#Create-the-Blockade-Subspace"><span>Create the Blockade Subspace</span></a></li><li><a class="tocitem" href="#Create-Registers-in-the-Subspace"><span>Create Registers in the Subspace</span></a></li><li><a class="tocitem" href="#Obtain-the-Hamiltonian-Matrix-in-the-Subspace"><span>Obtain the Hamiltonian Matrix in the Subspace</span></a></li><li><a class="tocitem" href="#Other-Operations-in-the-Subspace"><span>Other Operations in the Subspace</span></a></li><li><a class="tocitem" href="#Create-Constrained-Local-Hamiltonians-in-the-Subspace"><span>Create Constrained Local Hamiltonians in the Subspace</span></a></li></ul></li><li><a class="tocitem" href="../units/">Working with Units</a></li><li><a class="tocitem" href="../mis/">Maximum Independent Set</a></li><li><a class="tocitem" href="../multithreading/">CPU Acceleration</a></li><li><a class="tocitem" href="../cuda/">GPU Acceleration</a></li><li><a class="tocitem" href="../3-level/">3-Level Support and Quantum Gates</a></li><li><a class="tocitem" href="../schema/">Interacting with Neutral Atom Hardware</a></li><li><a class="tocitem" href="../capabilities/">Hardware Capabilities</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/1.blockade/main/">Rydberg Blockade</a></li><li><a class="tocitem" href="../tutorials/2.adiabatic/main/">Adiabatic Evolution</a></li><li><a class="tocitem" href="../tutorials/3.quantum-scar/main/">Quantum Scar</a></li><li><a class="tocitem" href="../tutorials/4.LGT/main/">Simulation of a Lattice Gauge Theory with Rydberg Atoms</a></li><li><a class="tocitem" href="../tutorials/5.MIS/main/">The Maximum Independent Set Problem</a></li><li><a class="tocitem" href="../tutorials/6.MWIS/main/">Maximum Weight Independent Set</a></li><li><a class="tocitem" href="../tutorials/7.QMC/main/">Quantum Monte Carlo Method</a></li><li><a class="tocitem" href="../tutorials/8.simulating noise/main/">Simulating Noise</a></li></ul></li><li><a class="tocitem" href="../contrib/">Contributing to Bloqade</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Working with Subspace</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Working with Subspace</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/QuEraComputing/Bloqade.jl/blob/master/docs/src/subspace.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="subspace"><a class="docs-heading-anchor" href="#subspace">Working with Subspace</a><a id="subspace-1"></a><a class="docs-heading-anchor-permalink" href="#subspace" title="Permalink"></a></h1><p>Due to the strong Rydberg interactions, only one Rydberg excitation is allowed if the atoms are close to each other.  We typically take this as the blockade radius, <span>$R_b$</span>, which is the  distance for which the Rydberg interaction is the same as the Rabi frequency, <span>$\Omega$</span> (see <a href="@ref blockade">Rydberg Blockade</a>). This is the so-called blockade constraint. </p><p>In Bloqade, we can take advantage of this effect by allowing users to run emulation in a truncated subspace, i.e., by throwing out states that violate the blockade constraint.  This can help accelerate the simulation and enables simulation for a larger system size.  In this section, we will show how to create a blockade subspace, create registers in the subspace,  obtain the Hamiltonian matrix in the subspace, and run emulation in the subspace.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Note that the blockade radius <span>$R_b$</span> is the distance for which the Rydberg interaction is the same as the Rabi frequency, <span>$\Omega$</span>.  For accurate simulation, however, it&#39;s not recommended to throw away the states that&#39;s close to the blockade radius. In other words, it&#39;s safer to set the subspace radius <span>$R_s$</span> to be smaller than <span>$R_b$</span>, where we throw away the blockade violated states when the atoms are within <span>$R_s$</span>.  For example, if we set <span>$R_s = 1/2 * R_b$</span>, we will be throwing away states that have interaction energies at least <span>$2^6*\Omega$</span>, which will be a good approximation.  See the <a href="@ref blockade">Rydberg Blockade</a> page for recommendations on how to set <span>$R_b$</span>, <span>$R_s$</span>, and the atom lattice separation, <span>$a$</span>.</p></div></div><h2 id="Create-the-Blockade-Subspace"><a class="docs-heading-anchor" href="#Create-the-Blockade-Subspace">Create the Blockade Subspace</a><a id="Create-the-Blockade-Subspace-1"></a><a class="docs-heading-anchor-permalink" href="#Create-the-Blockade-Subspace" title="Permalink"></a></h2><p>One can create a blockade subspace via the <code>blockade_subspace</code> method if we know the atomic positions: </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BloqadeMIS.blockade_subspace" href="#BloqadeMIS.blockade_subspace"><code>BloqadeMIS.blockade_subspace</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">blockade_subspace(atoms[, radius=1.0])</code></pre><p>Create a blockade approximation subspace from given atom positions and radius.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/QuEraComputing/Bloqade.jl/blob/5d3daf69b97a983c8675e3ea1d5c4aa82ae6b38c/lib/BloqadeMIS/src/subspace.jl#L52-L56">source</a></section></article><p>For example, we can construct a blockade subspace of a square lattice using the code below:</p><pre><code class="language-julia hljs">using Bloqade
atoms = generate_sites(SquareLattice(), 3, 3, scale=5.1)
space = blockade_subspace(atoms, 5.2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">9-qubits 63-elements Subspace{Int64, Vector{Int64}}:
───┬────
  <span class="sgr90">1</span>│ 0
  <span class="sgr90">2</span>│ 1
  <span class="sgr90">3</span>│ 2
  <span class="sgr90"> ⋮</span>│ ⋮
 <span class="sgr90">61</span>│ 337
 <span class="sgr90">62</span>│ 340
 <span class="sgr90">63</span>│ 341</code></pre><p>We first created a <span>$3*3$</span> square lattice with nearest neighbor atoms separated by <span>$5.1$</span> μm.  Then we have created a blockade subspace with the subspace radius, <span>$R_s$</span>, being <span>$5.2$</span> μm.  This means that if two atoms have a separation distance that is smaller than (or equal to) <span>$5.2$</span> μm,  then the blockade subspace does not contain states where both of them being in the Rydberg states. For the dictionary shown, the left is the new index of the states in the blockade subspace;  in this case, there are 63 allowed states, which is much smaller than the full Hilbert space size 512. The vectors on the right correspond to the base-10 representations of the states in bitstrings. </p><p>Here <code>space</code> is of the type <code>Subspace</code>:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BloqadeExpr.Subspace" href="#BloqadeExpr.Subspace"><code>BloqadeExpr.Subspace</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Subspace{S &lt;: AbstractVector} &lt;: AbstractSpace</code></pre><p>A <code>Dict</code>-like object stores the mapping between subspace and full space.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/QuEraComputing/Bloqade.jl/blob/5d3daf69b97a983c8675e3ea1d5c4aa82ae6b38c/lib/BloqadeExpr/src/space.jl#L22-L26">source</a></section></article><p>Other than using atomic positions and the subspace radius, we can also use a graph to create a subspace. In this case, the subspace  corresponds to the space composed by the <a href="https://en.wikipedia.org/wiki/Independent_set_(graph_theory)">independent sets</a> of this graph. Bloqade has an explicit function for this, by using a graph as  an input, and produces the subspace as the output. Here is an example code:</p><pre><code class="language-julia hljs">using Graphs

g = SimpleGraph(5)
edge_set = [(1,2), (1, 4), (2, 5), (3, 4)]
for (i,j) in edge_set
    add_edge!(g, i, j)
end
space = independent_set_subspace(g)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5-qubits 13-elements Subspace{Int64, Vector{Int64}}:
───┬───
  <span class="sgr90">1</span>│ 0
  <span class="sgr90">2</span>│ 1
  <span class="sgr90">3</span>│ 2
  <span class="sgr90"> ⋮</span>│ ⋮
 <span class="sgr90">11</span>│ 20
 <span class="sgr90">12</span>│ 21
 <span class="sgr90">13</span>│ 24</code></pre><h2 id="Create-Registers-in-the-Subspace"><a class="docs-heading-anchor" href="#Create-Registers-in-the-Subspace">Create Registers in the Subspace</a><a id="Create-Registers-in-the-Subspace-1"></a><a class="docs-heading-anchor-permalink" href="#Create-Registers-in-the-Subspace" title="Permalink"></a></h2><p>One can create a register in the subspace by feeding the <code>space</code> object instead of an integer for the common register interfaces, e.g.:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; zero_state(space)</code><code class="nohighlight hljs ansi" style="display:block;">SubspaceArrayReg{2, ComplexF64, Vector{ComplexF64}, Subspace{Int64, Vector{Int64}}}(5, ComplexF64[1.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im], Subspace{Int64, Vector{Int64}}(5, Dict(5 =&gt; 5, 16 =&gt; 9, 20 =&gt; 11, 24 =&gt; 13, 8 =&gt; 7, 17 =&gt; 10, 1 =&gt; 2, 0 =&gt; 1, 6 =&gt; 6, 4 =&gt; 4…), [0, 1, 2, 4, 5, 6, 8, 10, 16, 17, 20, 21, 24]))</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; product_state(bit&quot;000_000_001&quot;, space)</code><code class="nohighlight hljs ansi" style="display:block;">SubspaceArrayReg{2, ComplexF64, Vector{ComplexF64}, Subspace{Int64, Vector{Int64}}}(5, ComplexF64[0.0 + 0.0im, 1.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im], Subspace{Int64, Vector{Int64}}(5, Dict(5 =&gt; 5, 16 =&gt; 9, 20 =&gt; 11, 24 =&gt; 13, 8 =&gt; 7, 17 =&gt; 10, 1 =&gt; 2, 0 =&gt; 1, 6 =&gt; 6, 4 =&gt; 4…), [0, 1, 2, 4, 5, 6, 8, 10, 16, 17, 20, 21, 24]))</code></pre><p>Alternatively, if you have an existing state stored as a subtype of <code>AbstractVector</code>, you can also create the register using the constructor:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; state = rand(ComplexF64, length(space))</code><code class="nohighlight hljs ansi" style="display:block;">13-element Vector{ComplexF64}:
  0.3667996149753028 + 0.32360906569995485im
 0.08712655430454896 + 0.570289019448592im
  0.7554359292100319 + 0.815708325443451im
  0.8751921767162395 + 0.5042535378521092im
  0.9432403216124776 + 0.5273064230707782im
 0.22744254164261013 + 0.010695915805342127im
  0.7748139244555807 + 0.13727100074292153im
  0.9514010785851797 + 0.06424827662150512im
  0.4510863448772191 + 0.7060408284560913im
  0.5373782907792362 + 0.8370630578085726im
  0.9414425075615463 + 0.09715974205234956im
   0.516224454415695 + 0.8519824085717596im
  0.9001459300574639 + 0.38648294552334517im</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; reg = SubspaceArrayReg(state, space)</code><code class="nohighlight hljs ansi" style="display:block;">SubspaceArrayReg{2, ComplexF64, Vector{ComplexF64}, Subspace{Int64, Vector{Int64}}}(5, ComplexF64[0.3667996149753028 + 0.32360906569995485im, 0.08712655430454896 + 0.570289019448592im, 0.7554359292100319 + 0.815708325443451im, 0.8751921767162395 + 0.5042535378521092im, 0.9432403216124776 + 0.5273064230707782im, 0.22744254164261013 + 0.010695915805342127im, 0.7748139244555807 + 0.13727100074292153im, 0.9514010785851797 + 0.06424827662150512im, 0.4510863448772191 + 0.7060408284560913im, 0.5373782907792362 + 0.8370630578085726im, 0.9414425075615463 + 0.09715974205234956im, 0.516224454415695 + 0.8519824085717596im, 0.9001459300574639 + 0.38648294552334517im], Subspace{Int64, Vector{Int64}}(5, Dict(5 =&gt; 5, 16 =&gt; 9, 20 =&gt; 11, 24 =&gt; 13, 8 =&gt; 7, 17 =&gt; 10, 1 =&gt; 2, 0 =&gt; 1, 6 =&gt; 6, 4 =&gt; 4…), [0, 1, 2, 4, 5, 6, 8, 10, 16, 17, 20, 21, 24]))</code></pre><h2 id="Obtain-the-Hamiltonian-Matrix-in-the-Subspace"><a class="docs-heading-anchor" href="#Obtain-the-Hamiltonian-Matrix-in-the-Subspace">Obtain the Hamiltonian Matrix in the Subspace</a><a id="Obtain-the-Hamiltonian-Matrix-in-the-Subspace-1"></a><a class="docs-heading-anchor-permalink" href="#Obtain-the-Hamiltonian-Matrix-in-the-Subspace" title="Permalink"></a></h2><p>The matrix projected in the subspace of a given Hamiltonian can be obtained via <a href="../hamiltonians/#YaoAPI.mat"><code>mat</code></a> as well, e.g.:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; atoms = generate_sites(SquareLattice(), 3, 3, scale=5.1);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; space = blockade_subspace(atoms, 5.2);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; h1 = rydberg_h(atoms; Δ=2.0*2π, Ω=1.0*2π)</code><code class="nohighlight hljs ansi" style="display:block;"><span class="sgr36">nqubits: 9</span>
<span class="sgr31"><span class="sgr1">+</span></span>
├─ <span class="sgr33"><span class="sgr1">[+] </span></span>∑ 2π ⋅ 8.627e5.0/|x_i-x_j|^6 n_i n_j
├─ <span class="sgr33"><span class="sgr1">[+] </span></span>2π ⋅ 0.5 ⋅ ∑ σ^x_i
└─ <span class="sgr33"><span class="sgr1">[-] </span></span>2π ⋅ 2.0 ⋅ ∑ n_i</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; mat(h1, space)</code><code class="nohighlight hljs ansi" style="display:block;">63×63 SparseMatrixCSC{ComplexF64, Int64} with 366 stored entries:
⎡⡞⢍⡊⢄⠑⡀⠑⠄⠈⠢⡀⠀⠀⠀⠈⠢⡀⠀⠀⠀⠀⠑⢄⠀⠀⠀⠀⠀⠀⠀⠀⠀⎤
⎢⠊⢌⢱⢖⠀⠈⠀⠐⠄⠀⠈⠀⠀⠀⠀⠀⠈⠢⡀⠀⠀⠀⠀⠑⢄⠀⠀⠀⠀⠀⠀⠀⎥
⎢⠑⠠⡀⠀⢟⣵⠀⠀⠀⠀⠀⠑⢄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠑⢄⠀⠀⠀⠀⠀⎥
⎢⠑⠄⢀⠀⠀⠀⡟⢍⡄⠀⠀⠀⠀⠑⠄⠀⠀⠀⠈⠢⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⎥
⎢⠢⡀⠀⠁⠀⠀⠀⠉⢱⢖⠢⠢⠀⠢⡀⠀⠀⠀⠀⠀⠈⠀⠀⠀⠀⠀⠀⠢⡀⠀⠀⠀⎥
⎢⠀⠈⠂⠀⢄⠀⠀⠀⠨⡂⠛⣤⢕⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠢⡀⠀⎥
⎢⠀⠀⠀⠀⠀⠑⢄⠀⠠⡀⠑⠑⠛⣤⠄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠂⎥
⎢⠢⡀⠀⠀⠀⠀⠀⠁⠀⠈⠀⠀⠀⠁⢱⢖⠢⢂⠐⢄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⎥
⎢⠀⠈⠢⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠨⢂⠛⣤⠅⠀⢄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⎥
⎢⠀⠀⠀⠈⠀⠀⠢⡀⠀⠀⠀⠀⠀⠀⠐⢄⠁⠁⢱⢖⢂⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⎥
⎢⢄⠀⠀⠀⠀⠀⠀⠈⠂⠀⠀⠀⠀⠀⠀⠀⠀⠑⠈⠐⠛⣤⠤⡠⠀⢄⠀⢄⠀⠀⠀⠀⎥
⎢⠀⠑⢄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡣⠱⢆⣑⠀⠢⠀⠑⠄⠀⠀⎥
⎢⠀⠀⠀⠑⢄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢄⠑⠘⠑⣤⢄⠀⠀⠠⡀⠀⎥
⎢⠀⠀⠀⠀⠀⠑⠀⠀⠠⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢄⠈⠂⠀⠑⠛⣤⠤⡠⡈⠂⎥
⎢⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠢⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠑⠄⠀⡀⠀⡣⠱⢆⣐⠄⎥
⎣⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠢⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠢⠈⠐⠜⠵⠇⎦</code></pre><h2 id="Other-Operations-in-the-Subspace"><a class="docs-heading-anchor" href="#Other-Operations-in-the-Subspace">Other Operations in the Subspace</a><a id="Other-Operations-in-the-Subspace-1"></a><a class="docs-heading-anchor-permalink" href="#Other-Operations-in-the-Subspace" title="Permalink"></a></h2><p>All other operations in the subspace are the same as the fullspace case.  For example, to run an emulation in the subspace, one just need to use the subspace register <a href="../registers/#YaoSubspaceArrayReg.SubspaceArrayReg"><code>SubspaceArrayReg</code></a> instead of the fullspace register <a href="https://docs.yaoquantum.org/dev/man/registers.html#Array-Registers"><code>ArrayReg</code></a>. The rest of the code are the same:</p><pre><code class="language-julia hljs">reg = zero_state(space)
prob = SchrodingerProblem(reg, 1.0, h1)
emulate!(prob)
statevec(reg)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">63-element Vector{ComplexF64}:
    0.13585307850388811 + 0.7346213876906675im
 -0.0025450067101871437 + 0.03271936107717182im
   -0.09136564439212766 + 0.14709932277558319im
  -0.002545006710186996 + 0.032719361077171626im
    0.03640229629720841 - 0.04785883792433167im
   -0.09136564439212747 + 0.14709932277558346im
  -0.003520337809249168 - 0.13351187766013684im
  -0.009182822658231414 + 0.037741906756168286im
    0.21572816867719485 - 0.10378379639436613im
 -0.0010523745450196611 - 0.10411131375242312im
                        ⋮
    0.03640229629720796 - 0.047858837924331335im
     0.0773713073956402 - 0.032764420083013536im
  -0.007196192440743183 - 0.022872906698036075im
    0.07737130739564041 - 0.0327644200830134im
    0.13361821949331423 - 0.05657606453110492im
 -0.0023091347726957104 + 0.021944696595877302im
 -0.0018899409335649349 - 0.0019784347573578577im
 -0.0018899409335649594 - 0.0019784347573578724im
  -0.002966595829289374 + 0.0016052003624636947im</code></pre><p>Measurements on the subspace register is the same as that in the full space. </p><h2 id="Create-Constrained-Local-Hamiltonians-in-the-Subspace"><a class="docs-heading-anchor" href="#Create-Constrained-Local-Hamiltonians-in-the-Subspace">Create Constrained Local Hamiltonians in the Subspace</a><a id="Create-Constrained-Local-Hamiltonians-in-the-Subspace-1"></a><a class="docs-heading-anchor-permalink" href="#Create-Constrained-Local-Hamiltonians-in-the-Subspace" title="Permalink"></a></h2><p>Although we are able to emulate our Hamiltonian problem in the projected subspace, the long-range tail of   the Rydberg interactions will be present in the subspace Hamiltonian. In certain cases, you may not want the long-range tail by only simulating a constrained short-range Hamiltonian, e.g. <a href="https://arxiv.org/abs/2011.09486">the PXP model</a>. In this case, we can use Bloqade to easily deal with such problems for an arbitrary graph in an arbitrary dimension. </p><p>Let us take the PXP model in 1D as an example. We first create a 1D chain and then generate a subspace by projecting out states that have nearest-neighbor interactions. </p><pre><code class="language-julia hljs">atoms = generate_sites(ChainLattice(), 10, scale=5.1)
space = blockade_subspace(atoms, 5.2)
register = product_state(bit&quot;0101010101&quot;, space)
h = 2π * 4.0 * SumOfX(length(atoms)) - 2π * 1.0 * SumOfN(length(atoms))
prob = SchrodingerProblem(register, 0.2, h)
emulate!(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SchrodingerProblem:
  register info:
    type: <span class="sgr32">SubspaceArrayReg{2, ComplexF64, Vector{ComplexF64}, Subspace{Int64, Vector{Int64}}}</span>
    storage size: <span class="sgr33">40 bytes</span>

  time span (μs): (0.0, 0.2)

  equation: 
    storage size: <span class="sgr33">16.492 KiB</span>
    expression:
<span class="sgr36">nqubits: 10</span>
<span class="sgr31"><span class="sgr1">+</span></span>
├─ <span class="sgr33"><span class="sgr1">[scale: 25.132741228718345] </span></span>∑ σ^x_i
└─ <span class="sgr33"><span class="sgr1">[scale: -6.283185307179586] </span></span>∑ n_i


    algorithm: DP8(; stage_limiter! = trivial_limiter!, step_limiter! = trivial_limiter!, thread = static(false),)
  options:
    save_everystep: false
    save_start: false
    save_on: false
    dense: false
    reltol: 1.0e-10
    abstol: 1.0e-10
    alias_u0: true
</code></pre><p>After creating the subspace, we have built a Hamiltonian by explicitly summing up the Rabi frequency term  and the detuning term by using <a href="../hamiltonians/#BloqadeExpr.SumOfX"><code>SumOfX</code></a> and <a href="../hamiltonians/#BloqadeExpr.SumOfN"><code>SumOfN</code></a> respectively.  In this way, we have created a local constraint Hamiltonian (without the long-range interaction tail). Futhermore, if we want to emulate  quantum dynamics under this Hamiltonian, we just need to create a subspace register and emulate the system under the created Hamiltonian.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../emulation/">« Emulation</a><a class="docs-footer-nextpage" href="../units/">Working with Units »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.6.0 on <span class="colophon-date" title="Thursday 29 August 2024 22:39">Thursday 29 August 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
