<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Rydberg Blockade · Bloqade.jl</title><script data-outdated-warner src="../../../assets/warner.js"></script><link rel="canonical" href="https://QuEraComputing.github.io/Bloqade.jl/tutorials/1.blockade/main/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img class="docs-light-only" src="../../../assets/logo.svg" alt="Bloqade.jl logo"/><img class="docs-dark-only" src="../../../assets/logo-dark.svg" alt="Bloqade.jl logo"/></a><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../../install/">Installation</a></li><li><a class="tocitem" href="../../../julia/">The Julia Programming Language</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../lattices/">Lattices</a></li><li><a class="tocitem" href="../../../waveform/">Waveforms</a></li><li><a class="tocitem" href="../../../hamiltonians/">Hamiltonians</a></li><li><a class="tocitem" href="../../../registers/">Registers and Observables</a></li><li><a class="tocitem" href="../../../emulation/">Emulation</a></li><li><a class="tocitem" href="../../../subspace/">Working with Subspace</a></li><li><a class="tocitem" href="../../../units/">Working with Units</a></li><li><a class="tocitem" href="../../../mis/">Maximum Independent Set</a></li><li><a class="tocitem" href="../../../cuda/">GPU Acceleration</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li class="is-active"><a class="tocitem" href>Rydberg Blockade</a><ul class="internal"><li><a class="tocitem" href="#Blockade-radius-R_b,-subspace-radius-R_s,-and-unit-disk-graphs"><span>Blockade radius <span>$R_b$</span>, subspace radius <span>$R_s$</span>, and unit disk graphs</span></a></li><li><a class="tocitem" href="#Setting-Atom-Separation-Distance-from-the-Blockade-Radius"><span>Setting Atom Separation Distance from the Blockade Radius</span></a></li><li><a class="tocitem" href="#Example-Dynamics-in-the-Blockade-Subspace"><span>Example Dynamics in the Blockade Subspace</span></a></li></ul></li><li><a class="tocitem" href="../../2.adiabatic/main/">Adiabatic Evolution</a></li><li><a class="tocitem" href="../../3.quantum-scar/main/">Quantum Scar</a></li><li><a class="tocitem" href="../../4.LGT/main/">Simulation of lattice gauge theory with Rydberg atoms</a></li><li><a class="tocitem" href="../../5.MIS/main/">The Maximum Independent Set Problem</a></li><li><a class="tocitem" href="../../6.MWIS/main/">Maximum Weight Independent Set</a></li></ul></li><li><a class="tocitem" href="../../../contrib/">Contributing to Bloqade</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Rydberg Blockade</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Rydberg Blockade</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuEraComputing/Bloqade.jl/blob/master/examples/1.blockade/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="blockade"><a class="docs-heading-anchor" href="#blockade">Rydberg Blockade</a><a id="blockade-1"></a><a class="docs-heading-anchor-permalink" href="#blockade" title="Permalink"></a></h1><p>The Rydberg blockade mechanism is one of the most important phenomena of neutral atom quantum computing based on Rydberg interactions. By including a term in the effective Hamiltonian which adds an interaction between adjacent atoms in the Rydberg states, one can construct gates and nontrivial dynamics that create entanglement and correlation across the system.</p><p>The Rydberg interaction is a van der Waals interaction, where there is an energy shift if two adjacent atoms are both in the Rydberg state. The Van der Waals interaction is</p><p class="math-container">\[V_{jk} = \frac{C_6}{|\overrightarrow{\mathbf{r}_j} - \overrightarrow{\mathbf{r}_k}|^6}\hat n_j \hat n_k,\]</p><p>where <span>$\hat n_j=|r_j\rangle\langle r_j|$</span> is the number operator on the <span>$j$</span>th site, which is 1 if the atom is in the Rydberg state <span>$| r_j \rangle$</span>, and zero if the atom is in the ground state <span>$| g_j \rangle$</span>. The coefficient <span>$C_6 = 2\pi\times 862690 \text{ MHz μm}^6$</span> is the interaction strength; characteristically, this interaction has a strength <span>$C_6 \approx 2\pi\times 4$</span> MHz for two atoms separated by <span>$7.74$</span> μm, a similar scale to the Rabi frequency coupling the ground and the Rydberg state. Crucially, this can be seen as an energy shift on atom <span>$k$</span>, conditional on the state of atom <span>$j$</span>, and so can be used, in a loose sense, as a conditional logical gate. This is because the adjacent atom forces the atom to be off-resonant with the laser field if it is in the Rydberg state. Please refer to the <a href="../../../hamiltonians/#Hamiltonians">Hamiltonians</a> page for descriptions of all the terms in the Rydberg Hamiltonian.</p><p>This conditional drive can be seen given the following dynamics. Suppose two atoms are close to each other (<span>$&lt; 10$</span> μm) and so experience a strong Rydberg interaction. The left atom is either in a Rydberg state, or in the ground state, and the right atom is originally in the ground state. Then, a Rabi drive is applied to the right atom, which couples the atom&#39;s ground state to the Rydberg state. For this example, we choose a Rabi frequency of <span>$\Omega=2\pi\times 0.5$</span> MHz and distance between atoms <span>$|\overrightarrow{\mathbf{r}_j} - \overrightarrow{\mathbf{r}_k}| = 7$</span> μm, which gives a conditional detuning (Rydberg interaction) of <span>$\approx 2\pi \times 7.33$</span> MHz. When the left atom is in the ground state (black, top), there are no interactions and the state of the right atom experiences standard <a href="https://en.wikipedia.org/wiki/Rabi_cycle">Rabi oscillation</a> between the ground state and the Rydberg state; for a particular choice of timing, this executes a <span>$\pi$</span> pulse, flipping the right atom from the ground to the Rydberg state. However, when the left atom is in the Rydberg state (red, bottom), there is a large detuning on the right atom due to the strong Rydberg interaction, which causes the transfer to the Rydberg state to be strongly suppressed. In this case, the right atom (up to perturbative corrections) is never in the Rydberg state. This is the so-called Rydberg blockade.</p><p><img src="../../../assets/RydbergBlockade.png" alt="RydbergBlockade"/></p><p>Because of the large energy shift from having two adjacent atoms in the Rydberg state, evolution from an atomic ground state with local Rabi couplings between ground and Rydberg is restricted to a low-energy subspace of states where no two adjacent atoms are in the Rydberg state. Furthermore, because the interaction strength with distance is a large power law, one can define a characteristic scale set by the Rabi frequency. If two atoms are close such that the conditional detuning is much larger than the Rabi frequency, one can consider the atoms to be blockading each other, and both atoms cannot simultaneously be in the Rydberg state. In contrast, if two atoms are far away, the two atoms never blockade each other and both atoms can simultaneously be in the Rydberg state.</p><h2 id="Blockade-radius-R_b,-subspace-radius-R_s,-and-unit-disk-graphs"><a class="docs-heading-anchor" href="#Blockade-radius-R_b,-subspace-radius-R_s,-and-unit-disk-graphs">Blockade radius <span>$R_b$</span>, subspace radius <span>$R_s$</span>, and unit disk graphs</a><a id="Blockade-radius-R_b,-subspace-radius-R_s,-and-unit-disk-graphs-1"></a><a class="docs-heading-anchor-permalink" href="#Blockade-radius-R_b,-subspace-radius-R_s,-and-unit-disk-graphs" title="Permalink"></a></h2><p>The blockade radius is defined as the distance at which the Rydberg interaction energy is the same as the Rabi frequency</p><p class="math-container">\[\frac{C_6}{R_b^6} = \Omega,\]</p><p>where <span>$R_b$</span> is the blockade radius, which sets the characteristic distance scale for which Rydberg interaction will be strong compared to the coupling strength between the ground and the Rydberg state set by <span>$\Omega$</span>. In the above example, <span>$\Omega = 2\pi\times 0.5$</span> MHz, so <span>$R_b = (C_6 / \Omega)^{1/6} \approx 10.95$</span>  μm. In practice, the blockade approximation, i.e., truncating the states that have both atoms in the Rydberg state, may not be a good approximation at the distance <span>$R_b$</span>, since it is more like the onset energy scale at which Rydberg interaction becomes strong. For a better blockade approximation, the atoms should be closer than <span>$R_b$</span>. We refer this distance as the subspace radius <span>$R_s$</span> (<span>$R_s \leq R_b$</span>), at which we claim it will be a reasonably good approximation to throw away all the states that have more than one Rydberg states whenever they are within the radius <span>$R_s$</span>.</p><p>Therefore, in simulating the quantum dynamics, instead of doing it in the full <span>$2^N$</span> Hilbert space, we may take advantage of the energy structure and truncate those blockade-violated states. Mathematically, this is related to the <a href="../../5.MIS/main/#mis-tutorial">independent sets</a> of the unit disk graph defined by the positions of the atoms. A unit disk graph is a set of vertices and edges, where each vertex represents an atom, and there are edges if the distance between vertices is less than or equal to some unit disk radius <span>$|\overrightarrow{\mathbf{r}_j} - \overrightarrow{\mathbf{r}_k}| \leq R_u$</span>. An independent set is a set of vertices in the graph such that no two of which are connected by an edge. Thus, the non-blockade-violated states are the independent set states of the corresponding unit disk graph, where the independent set consists of the vertices (atoms) that are excited to the Rydberg state. If we set <span>$R_u = R_s$</span>, it will be a good approximation to throw away those non-independent-sets. In practice, a priori, it may not be easy to know what will be a good choice for <span>$R_s$</span>, since it depends on the specific atom arrangement and the specific many-body quantum dynamics. For example, if <span>$R_s = 1/2 * R_b$</span>, we will be throwing away states that have interaction energies at least <span>$2^6*\Omega$</span>, which will typically be a very good approximation. In the two-atom example above, we can set <span>$R_s = 7$</span> μm and throw away the state when both atoms are in the Rydberg state, which is quite good an approximation as seen in the figure. In this case, the Rydberg-blockaded state has an interaction of <span>$(R_b / R_s)^6 \Omega \approx 14.7 \Omega$</span>. When the blockade approximation is valid, the computational states would be separated into bands due to the strong Rydberg interaction, and there will be small perturbative coupling between the bands due to the Rabi coupling, (which is typically in the order of <span>$(\Omega / V_{jk})^2$</span>). See the illustrative figure below:</p><p><img src="../../../assets/bloqade_subspace.png" alt="EnergyTruncation"/></p><p>The lowest energy states are representative of independent sets of the unit disk graph, where Rydberg excitations are in the independent set and no two Rydberg excitations are within the unit disk radius. The second energy band are sets with a single independent set violation, where there are equivalently just two Rydberg excitations within the unit disk radius of each other. Higher and higher bands represent more and more independent set violations. We emphasize again that this band structure is dependent on the arrangement of atoms, and for arbitrary configurations, this band structure may not be clear.</p><p>To run more efficient simulation in the blockade <a href="../../../subspace/#subspace">subspace</a>, the simplest scheme is to truncate the Hilbert space to the low-energy subspace, and exclude all states above a certain energy. Given the natural band structure of the classical Hamiltonian, we may simply truncate the Hilbert space to the subspace of independent sets of the unit disk graph with the unit disk radius set as <span>$R_u = R_s$</span>. Equivalently, this is the <strong>blockade subspace</strong>, where atoms within the subspace radius are excluded from both being in the Rydberg state. The validity of the energy truncation subspace is governed by the strength of off-diagonal matrix elements coupling the low-energy subspace to the high-energy one. For the Rydberg Hamiltonian, these off-diagonal elements <span>$|1r\rangle\leftrightarrow|rr\rangle$</span> have a strength <span>$\Omega$</span>. In order to preserve dynamics within the subspace, the energy difference between states within the blockade subspace (e.g., <span>$|1r\rangle$</span>) and outside (<span>$|rr\rangle$</span>) must be much larger than the Rabi strength. Formally, if <span>$\Omega \ll C_6/R_s^6$</span>, then the blockade approximation should be valid (the perturbation is typically in the second order <span>$(\Omega/ (C_6/R_s^6))^2$</span>). As long as this condition holds, the exact dynamics in the full Hilbert space should be closely approximated by the approximate dynamics in the blockade subspace, as the mixing terms only couple to low-energy states.</p><p>Please also refer to the <a href="../../../subspace/#subspace">subspace</a> page for more details on running simulation in the subspace. Also, see <a href="../../5.MIS/main/#mis-tutorial">MIS tutorial</a> for more descriptions on the correspondence between the independent set constraint and the blockade constraint, and a tutorial on how to solve the maximum independent set problem using Rydberg Hamiltonians.</p><h2 id="Setting-Atom-Separation-Distance-from-the-Blockade-Radius"><a class="docs-heading-anchor" href="#Setting-Atom-Separation-Distance-from-the-Blockade-Radius">Setting Atom Separation Distance from the Blockade Radius</a><a id="Setting-Atom-Separation-Distance-from-the-Blockade-Radius-1"></a><a class="docs-heading-anchor-permalink" href="#Setting-Atom-Separation-Distance-from-the-Blockade-Radius" title="Permalink"></a></h2><p>Suppose given certain arrangement of atoms, we would like to have the close-by atoms to be mutually blockaded, while the far-away atoms to be non-blockaded. This corresponds to a unit disk graph and the distance scale can be set by the blockade radius <span>$R_b$</span>. For any two atoms within the unit disk radius <span>$R_u$</span>, the energy scale of having both in the Rydberg state must be much larger than <span>$\Omega$</span>; this sets a lower bound for <span>$R_u$</span> compared to <span>$R_b$</span>. On the other hand, for any two atoms outside of the unit disk radius, the energy scale of having both be in the Rydberg state must be much smaller than <span>$\Omega$</span>, as the two atoms should not be blockaded; this sets an upper bound for <span>$R_u$</span>, as there are still <span>$1/R^6$</span> interactions between nearby atoms which may &quot;accidentally&quot; blockade each other if <span>$R_u$</span> is too large to include the supposedly unblockaded atoms. This upper bound on <span>$R_u$</span> guarantees that dynamics occur within the correct independent set subspace and is not affected by long-range &quot;Rydberg tails&quot;, which cause each independent set state to have a slightly different energy.</p><p>More specifically, we denote the lower bound as <span>$R_\text{min}$</span>, which is the minimum <span>$R_u$</span> can be without removing any edges from the unit disk graph. Equivalently, it is the maximum distance between vertices that are connected by an edge. We denote the upper bound as <span>$R_\text{max}$</span>, which is the maximum <span>$R_u$</span> can be without adding any additional edges to the unit disk graph. This is equivalently the minimum distance between vertices that are <em>not</em> connected by an edge in the unit disk graph. Therefore, we have <span>$R_\text{min}\leq R_u &lt; R_\text{max}$</span>.</p><p>The actual scale for <span>$R_\text{min}, R_u, R_\text{max}$</span> can be set by <span>$R_b$</span>. In order to fulfill the condition</p><p class="math-container">\[ \frac{C_6}{R_\text{max}^6} \ll \Omega \equiv \frac{C_6}{R_b^6} \ll \frac{C_6}{R_\text{min}^6}\]</p><p>as much as possible, it&#39;s best to have</p><p class="math-container">\[R_b = \sqrt{R_\text{min} R_\text{max}} = R_\text{min} * \sqrt{\frac{R_\text{max}}{R_\text{min}}}
\quad \Rightarrow \quad R_\text{min} = R_b * \sqrt{\frac{R_\text{min}}{R_\text{max}}}.\]</p><p>Now, there are several characteristic distances. To summarize, we have:</p><ul><li><p><span>$R_u$</span> is the unit disk radius of the graph. Usually, this is taken to be <span>$R_u = R_\text{min}$</span>, though generally <span>$R_\text{min} \leq R_u &lt; R_\text{max}$</span>.</p></li><li><p><span>$R_\text{min}$</span> is the minimum <span>$R_u$</span> can be without removing any edges from the unit disk graph.</p></li><li><p><span>$R_\text{max}$</span> is the maximum <span>$R_u$</span> can be without adding any edges from the unit disk graph.</p></li><li><p><span>$R_b$</span> is the <strong>blockade radius</strong> of the system defined as <span>$C_6/R_b^6 = \Omega$</span>. It&#39;s preferable to scale <span>$R_\text{min}$</span> and <span>$R_\text{max}$</span> such that <span>$R_b = \sqrt{R_\text{min} R_\text{max}}$</span>.</p></li><li><p><span>$R_s$</span> is the subspace radius, at which it is a good approximation to truncate the Hilbert space when two Rydberg excitations are closer than <span>$R_s$</span>. We have <span>$R_s \leq R_b$</span>.</p></li></ul><p>Note that <span>$R_s$</span> is used only for faster simulation in the truncated blockade subspace. The smaller the <span>$R_s$</span>, the better the approximation for the simulation. When <span>$R_s = 0$</span>, one recovers the full-space simulation.</p><p>Below, we explain how to set the distance scale using a few example unit disk graphs.</p><p><img src="../../../assets/bloqade_subspace_UDGradius.png" alt="BlockadRadius"/></p><p>In these examples in the above figure, <span>$R_\text{min}$</span> is the radius of the dark-red disk, <span>$R_\text{max}$</span> is the radius of the light-red disk, and <span>$R_b$</span> is the radius of the red-dashed circle. The ratios <span>$R_\text{max}/R_\text{min}$</span> are shown for several arrangements of atoms. For the 1D chain with nearest-neighbor blockade, let&#39;s say the lattice constant is <span>$a$</span> with <span>$R_\text{min} = a$</span> and <span>$R_\text{max} = 2a$</span>. So with <span>$R_b = \sqrt{R_\text{min} R_\text{max}}$</span>, we have <span>$a = R_b/\sqrt{2}$</span>. Therefore,</p><ul><li>For a given <span>$\Omega = 2\pi \times 4$</span> MHz,</li><li><span>$R_b = (C_6 / \Omega)^{1/6} \approx 7.74$</span> μm,</li><li><span>$a = R_b /\sqrt{2} \approx 5.48$</span> μm.</li></ul><p>Thus, for the <span>$Z_2$</span> phase transition of the <a href="tutorials/1.blockade/@ref Adiabatic Evolution">adiabatic example</a> and in the 1D <a href="https://www.nature.com/articles/nature24622">paper</a>, it is good to set <span>$a = 5.48$</span> μm. Similarly, one can compute that <span>$a = 3.16$</span> μm and <span>$a = 2.24$</span> μm will be good choices for observing <span>$Z_3$</span> and <span>$Z_4$</span> phase transitions in the 1D chain. For the 2D square lattice, <span>$a = 6.51$</span> μm and <span>$a = 4.60$</span> μm are good options for observing the checkerboard phase (nearest-neighbor blockade) and the striated phase (next-nearest-neighbor blockade) as in this <a href="https://www.nature.com/articles/s41586-021-03582-4">paper</a>, following the same rationale as above. Here, we summarize the recommended lattice constants (unit μm) for common lattices in the following table:</p><table><tr><th style="text-align: center"></th><th style="text-align: center"><span>$R_\text{min}$</span></th><th style="text-align: center"><span>$R_\text{max}$</span></th><th style="text-align: center"><span>$a$</span> for <span>$\Omega = 2\pi * 4$</span> MHz</th><th style="text-align: center"><span>$a$</span> for <span>$\Omega = 2\pi * 10$</span> MHz</th></tr><tr><td style="text-align: center">Chain <span>$Z_2$</span></td><td style="text-align: center"><span>$a$</span></td><td style="text-align: center"><span>$2a$</span></td><td style="text-align: center">5.48</td><td style="text-align: center">4.70</td></tr><tr><td style="text-align: center">Chain <span>$Z_3$</span></td><td style="text-align: center"><span>$2a$</span></td><td style="text-align: center"><span>$3a$</span></td><td style="text-align: center">3.16</td><td style="text-align: center">2.71</td></tr><tr><td style="text-align: center">Chain <span>$Z_4$</span></td><td style="text-align: center"><span>$3a$</span></td><td style="text-align: center"><span>$4a$</span></td><td style="text-align: center">2.24</td><td style="text-align: center">1.92</td></tr><tr><td style="text-align: center">Square checkerboard</td><td style="text-align: center"><span>$a$</span></td><td style="text-align: center"><span>$\sqrt{2}a$</span></td><td style="text-align: center">6.51</td><td style="text-align: center">5.59</td></tr><tr><td style="text-align: center">Square striated</td><td style="text-align: center"><span>$\sqrt{2}a$</span></td><td style="text-align: center"><span>$2a$</span></td><td style="text-align: center">4.60</td><td style="text-align: center">3.95</td></tr><tr><td style="text-align: center">Square star</td><td style="text-align: center"><span>$2a$</span></td><td style="text-align: center"><span>$\sqrt{5}a$</span></td><td style="text-align: center">3.66</td><td style="text-align: center">3.14</td></tr><tr><td style="text-align: center">Lieb NN</td><td style="text-align: center"><span>$a$</span></td><td style="text-align: center"><span>$2a$</span></td><td style="text-align: center">5.48</td><td style="text-align: center">4.70</td></tr><tr><td style="text-align: center">Lieb NNN</td><td style="text-align: center"><span>$2a$</span></td><td style="text-align: center"><span>$\sqrt{5}a$</span></td><td style="text-align: center">3.66</td><td style="text-align: center">3.14</td></tr><tr><td style="text-align: center">Lieb NNNN</td><td style="text-align: center"><span>$\sqrt{5}a$</span></td><td style="text-align: center"><span>$\sqrt{8}a$</span></td><td style="text-align: center">3.08</td><td style="text-align: center">2.64</td></tr><tr><td style="text-align: center">Triangular NN</td><td style="text-align: center"><span>$a$</span></td><td style="text-align: center"><span>$\sqrt{3}a$</span></td><td style="text-align: center">5.88</td><td style="text-align: center">5.05</td></tr><tr><td style="text-align: center">Triangular NNN</td><td style="text-align: center"><span>$\sqrt{3}a$</span></td><td style="text-align: center"><span>$2a$</span></td><td style="text-align: center">4.16</td><td style="text-align: center">3.57</td></tr><tr><td style="text-align: center">Honeycomb NN</td><td style="text-align: center"><span>$a$</span></td><td style="text-align: center"><span>$\sqrt{3}a$</span></td><td style="text-align: center">5.88</td><td style="text-align: center">5.05</td></tr><tr><td style="text-align: center">Honeycomb NNN</td><td style="text-align: center"><span>$\sqrt{3}a$</span></td><td style="text-align: center"><span>$2a$</span></td><td style="text-align: center">4.16</td><td style="text-align: center">3.57</td></tr><tr><td style="text-align: center">Kagome NN</td><td style="text-align: center"><span>$a$</span></td><td style="text-align: center"><span>$\sqrt{3}a$</span></td><td style="text-align: center">5.88</td><td style="text-align: center">5.05</td></tr><tr><td style="text-align: center">Kagome NNN</td><td style="text-align: center"><span>$\sqrt{3}a$</span></td><td style="text-align: center"><span>$2a$</span></td><td style="text-align: center">4.16</td><td style="text-align: center">3.57</td></tr></table><p>Other than regular lattices, for an example arbitrary graph shown in the right most panel of the above figure, one only has <span>$R_\text{max}/R_\text{min} \approx 1.15$</span>. Thus, there is only a small window to set the unit disk radius, and the energy scale for the blockaded versus non-blockaded Rydberg interaction is not as large (<span>$1.15^6 \approx  2.34$</span>). Thus, the blockade approximation for the atoms with a separation close to the blockade radius will not be as good. For accurate simulation of the actual Rydberg dynamics, one should take a subspace radius <span>$R_s \ll R_\text{min}$</span>. Therefore, we can see that graphs on a regular lattice typically have larger and better energy separation between the blockaded and the non-blockaded states than arbitrary graphs.</p><p>Below, we give an example of doing the simulation in the blockade subspace for a ring system. For more information on subspace emulation, please refer to the <a href="../../../subspace/#subspace">subspace</a> page.</p><h2 id="Example-Dynamics-in-the-Blockade-Subspace"><a class="docs-heading-anchor" href="#Example-Dynamics-in-the-Blockade-Subspace">Example Dynamics in the Blockade Subspace</a><a id="Example-Dynamics-in-the-Blockade-Subspace-1"></a><a class="docs-heading-anchor-permalink" href="#Example-Dynamics-in-the-Blockade-Subspace" title="Permalink"></a></h2><p>To emphasize the effectiveness of the subspace emulation, some example nonequilibrium dynamics are shown below, for a ring of <span>$12$</span> atoms seperated by <span>$R_\text{min} = 6.9$</span> μm. The minimum distance of atoms not within the blockade radius is <span>$R_\text{max} \approx 13.33$</span> μm (next-nearest neighbor separation), Thus, the blockade radius can be <span>$R_b = 6.9 \times \sqrt{13.33/6.9} \approx 9.59$</span> μm. This blockade energy scale corresponds to <span>$\Omega \approx 2\pi * 1.11$</span> MHz, and the perturbative limits to be <span>$\Omega \ll C_6/R_\text{min} \approx 7.99$</span> MHz and <span>$\Omega \gg C_6/R_\text{max} \approx 0.15$</span> MHz.</p><p>Note that in this example, we set the blockade radius from <span>$R_\text{min}$</span> and <span>$R_\text{max}$</span>, and then obtain Rabi frequency <span>$\Omega$</span> from the blockade radius. In practice, it&#39;s often the opposite order for specification on the hardware. <span>$\Omega$</span> is typically limited by the laser power on the hardware. Thus, one starts from a given <span>$\Omega$</span>, which determines the blockade radius, <span>$R_b$</span>, which can then inform the separation between atoms as described in the previous section. If one starts from the atom separation distance first, it may often results in a Rabi frequency that is too large or too small to be feasible on the neutral-atom hardware.</p><p>The set of atoms for this ring example can be defined by:</p><pre><code class="language-julia hljs">using Bloqade
nsites = 12; # 12-site ring
unit_disk_radius = 6.9 # Distance between nearest-neighbor atoms, in microns; R_min

R = unit_disk_radius / (2 * sin(2 * pi / (nsites) / 2)) # Radius of the circle, using a little trigonometry; it is also the next-nearest neighbor distance, R_max.
pos = [(R * sin(i * 2 * pi / (nsites)), R * cos(i * 2 * pi / (nsites))) for i in 1:nsites] # Positions of each atom
atoms = AtomList(pos); # Define the atom positions as an AtomList.

blockade_radius = sqrt(unit_disk_radius * R);  # R_b = \sqrt{R_min R_max}</code></pre><p>The system is driven by a constant Rabi drive, which couples each atom&#39;s ground and Rydberg state. The Hamiltonian can be defined in Bloqade with:</p><pre><code class="language-julia hljs">C6 = 2π * 862690;
Ω = C6 / blockade_radius^6
h = rydberg_h(atoms; Ω = Ω);</code></pre><p>The system is then initialized into the ground state of all atoms, which is the lowest energy of the classical Hamiltonian. We have two choices of basis: the first choice is the full Hilbert space of <span>$2^{12}$</span> elements, whereas the second basis is the blockade subspace, which excludes Rydberg excitations within the <strong>subspace radius</strong>, <span>$R_s$</span>. In principle, the subspace radius can be taken to be any value less than the blockade radius, but for better approximation, it is better to take smaller <span>$R_s$</span>. Typically, <span>$R_s &lt; R_b / 1.7$</span> will be reasonably good approximation, since states with Rydberg interaction <span>$1.7^6 \Omega \approx 24 \Omega$</span> will be then truncated, and the perturbative truncation error is typically in second order. For <span>$R_s = 0$</span>, no states are excluded and one recovers the exact dynamics. For a subspace radius anywhere between <span>$R_\text{min}$</span> and <span>$R_\text{max}$</span>, the subspace is the same, as there are no vertices having a separation within those radii. Here, we choose the subspace radius for the ring of atoms to be the unit disk radius, which corresponds to truncating the states having a Rydberg interaction <span>$&gt;(R_b/R_u)^6 \Omega \approx 7.2 \Omega$</span>. For more general graphs, it may be reasonable to choose the subspace radius to be smaller than the unit disk radius and include extra states to improve the fidelity of the energy truncation. For example, for the next-nearest-neighbor line, it may be reasonable to choose the subspace radius to be half the blockade radius, which includes high-energy NNN blockaded states to improve numerical accuracy. See the <a href="../../../subspace/#subspace">subspace</a> page for more details.</p><pre><code class="language-julia hljs">subspace_radius = unit_disk_radius # R_s

init_state = zero_state(nsites) # Define the initial state in the full space.
space = blockade_subspace(atoms, subspace_radius) # Compute the blockade subspace with R_s.
init_state2 = zero_state(space); # Define the initial state in the blockade subspace.</code></pre><p>The blockade subspace has <span>$D=322$</span> elements, which is much smaller than <span>$2^{12}$</span>, so the emulation will be much faster. If the atoms were far apart and non-interacting, each atom would oscillate completely between its ground state and Rydberg state with a period of <span>$\approx 0.5$</span> μs. However, because adjacent atoms shift to the Rydberg state concurrently, they are dynamically blockaded, causing the maximum Rydberg density to only be <span>$1/2$</span>, corresponding to an antiferromagnetic <span>$Z_2$</span> state. Note that because the ring has a translation symmetry, the Rydberg density is equal on all sites.</p><pre><code class="language-julia hljs">Tmax = 6.0
nsteps = 2001
times = LinRange(0, Tmax, nsteps)
dt = Tmax / (nsteps - 1)

prob = SchrodingerProblem(init_state, Tmax, h, dt = dt, adaptive = false);
integrator = init(prob, Vern8());

densities = [] # Time evolve the system in the full space
for _ in TimeChoiceIterator(integrator, 0.0:dt:Tmax)
    push!(densities, rydberg_density(init_state, 1))
end

prob2 = SchrodingerProblem(init_state2, Tmax, h, dt = dt, adaptive = false);
integrator2 = init(prob2, Vern8());

densities2 = [] # Time evolve the system in the subspace
for _ in TimeChoiceIterator(integrator2, 0.0:dt:Tmax)
    push!(densities2, rydberg_density(init_state2, 1))
end</code></pre><p>Plot the data:</p><pre><code class="language-julia hljs">using PythonCall # Use matplotlib to generate plots
matplotlib = pyimport(&quot;matplotlib&quot;)
plt = pyimport(&quot;matplotlib.pyplot&quot;)

ax = plt.subplot(1, 1, 1)
plt.plot(times, real(densities), &quot;k&quot;, label = &quot;Full space&quot;)
plt.plot(times, real(densities2), &quot;r--&quot;, label = &quot;Subspace&quot;)
ax.axis([0, Tmax, 0, 0.45])
plt.xlabel(&quot;Time (us)&quot;)
plt.ylabel(&quot;Rydberg density&quot;)
plt.tight_layout()
plt.legend()

inset_axes = pyimport(&quot;mpl_toolkits.axes_grid1.inset_locator&quot;)
ax2 = inset_axes.inset_axes(ax, width = &quot;20%&quot;, height = &quot;30%&quot;, loc = &quot;lower right&quot;, borderpad = 1)
plt.plot(times, real(densities - densities2))
plt.axis([0, 0.5, -0.001, 0.003])
plt.ylabel(&quot;Difference&quot;, fontsize = 12)
plt.yticks(LinRange(-0.001, 0.003, 5), fontsize = 12);
plt.xticks([0, 0.2, 0.4, 0.6], fontsize = 12);</code></pre><p><img src="../../../assets/RydbergBlockadeSubspace.png" alt="RydbergBlockadeSubspace"/></p><p>Data for this evolution is shown above, where exact evolution in the full space is shown in black, and the truncated evolution in the subspace is shown by red dashed. It is clear that even though the Hilbert space is <span>$12\times$</span> smaller, the dynamics are faithfully reproduced, up to high frequency oscillations (inset) from adjacent atoms in the Rydberg state, similar to the high frequency oscillations of the 2-atom conditional blockade example above. However, at longer times, this subspace approximation fails to reproduce the full space (shown by divergence between black and red dashed), as the perturbative effects become relevant over longer timescales.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../../cuda/">« GPU Acceleration</a><a class="docs-footer-nextpage" href="../../2.adiabatic/main/">Adiabatic Evolution »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Saturday 30 July 2022 19:44">Saturday 30 July 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
