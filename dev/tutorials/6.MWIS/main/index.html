<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Maximum Weight Independent Set · Bloqade.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-SRKGL6MJHS"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-SRKGL6MJHS', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../../assets/warner.js"></script><link rel="canonical" href="https://QuEraComputing.github.io/Bloqade.jl/tutorials/6.MWIS/main/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="../../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img class="docs-light-only" src="../../../assets/logo.svg" alt="Bloqade.jl logo"/><img class="docs-dark-only" src="../../../assets/logo-dark.svg" alt="Bloqade.jl logo"/></a><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../../install/">Installation</a></li><li><a class="tocitem" href="../../../julia/">The Julia Programming Language</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../lattices/">Lattices</a></li><li><a class="tocitem" href="../../../waveform/">Waveforms</a></li><li><a class="tocitem" href="../../../hamiltonians/">Hamiltonians</a></li><li><a class="tocitem" href="../../../registers/">Registers and Observables</a></li><li><a class="tocitem" href="../../../emulation/">Emulation</a></li><li><a class="tocitem" href="../../../subspace/">Working with Subspace</a></li><li><a class="tocitem" href="../../../units/">Working with Units</a></li><li><a class="tocitem" href="../../../mis/">Maximum Independent Set</a></li><li><a class="tocitem" href="../../../multithreading/">CPU Acceleration</a></li><li><a class="tocitem" href="../../../cuda/">GPU Acceleration</a></li><li><a class="tocitem" href="../../../3-level/">3-Level Support and Quantum Gates</a></li><li><a class="tocitem" href="../../../schema/">Interacting with Neutral Atom Hardware</a></li><li><a class="tocitem" href="../../../capabilities/">Hardware Capabilities</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../1.blockade/main/">Rydberg Blockade</a></li><li><a class="tocitem" href="../../2.adiabatic/main/">Adiabatic Evolution</a></li><li><a class="tocitem" href="../../3.quantum-scar/main/">Quantum Scar</a></li><li><a class="tocitem" href="../../4.LGT/main/">Simulation of a Lattice Gauge Theory with Rydberg Atoms</a></li><li><a class="tocitem" href="../../5.MIS/main/">The Maximum Independent Set Problem</a></li><li class="is-active"><a class="tocitem" href>Maximum Weight Independent Set</a><ul class="internal"><li><a class="tocitem" href="#Background"><span>Background</span></a></li><li class="toplevel"><a class="tocitem" href="#Quantum-Adiabatic-Algorithm-to-Solve-the-MWIS-Problem"><span>Quantum Adiabatic Algorithm to Solve the MWIS Problem</span></a></li><li><a class="tocitem" href="#Building-Pulse-Sequences"><span>Building Pulse Sequences</span></a></li><li><a class="tocitem" href="#Compute-the-MIS-Probability-and-the-Adiabatic-Timescale"><span>Compute the MIS Probability and the Adiabatic Timescale</span></a></li></ul></li><li><a class="tocitem" href="../../7.QMC/main/">Quantum Monte Carlo Method</a></li></ul></li><li><a class="tocitem" href="../../../contrib/">Contributing to Bloqade</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Maximum Weight Independent Set</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Maximum Weight Independent Set</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuEraComputing/Bloqade.jl/blob/master/examples/6.MWIS/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Maximum-Weight-Independent-Set"><a class="docs-heading-anchor" href="#Maximum-Weight-Independent-Set">Maximum Weight Independent Set</a><a id="Maximum-Weight-Independent-Set-1"></a><a class="docs-heading-anchor-permalink" href="#Maximum-Weight-Independent-Set" title="Permalink"></a></h1><h2 id="Background"><a class="docs-heading-anchor" href="#Background">Background</a><a id="Background-1"></a><a class="docs-heading-anchor-permalink" href="#Background" title="Permalink"></a></h2><p>In the <a href="../../5.MIS/main/#mis-tutorial">The Maximum Independent Set Problem</a> tutorial, we provide a detailed example on how to solve the Maximum Independent Set (MIS) problem using neutral-atom quantum computers. The first algorithm proposal and experimental demonstration can be found in <a href="https://arxiv.org/pdf/1808.10816.pdf">H. Pichler et al. (10.48550/arXiv.1808.10816)</a> and <a href="https://arxiv.org/abs/2202.09372">S. Ebadi et al. (10.48550/arXiv.2202.09372)</a>. In this tutorial, we present a more advanced example of using neutral atom quantum computers to solve the <a href="https://en.wikipedia.org/wiki/Independent_set_(graph_theory)">Maximum Weight Independent Set</a> (MWIS) problem on a weighted unit disk graph, with arbitrary weights for each vertex. The MWIS problem seeks to find an independent set whose weights sum to the maximum possible value.</p><p>We first import the required packages to compute MWIS classically:</p><pre><code class="language-julia hljs">using Random
Random.seed!(42)
using Graphs
using GenericTensorNetworks
using GenericTensorNetworks: unit_disk_graph
using Bloqade
using PythonCall
plt = pyimport(&quot;matplotlib.pyplot&quot;);</code></pre><p>We now specify the atom locations and construct an example unit disk graph on a square lattice with nearest-neighbor connections. The atoms represent vertices on the problem graph, and all vertices closer than a distance 1.5 are connected by an edge:</p><pre><code class="language-julia hljs">locs = [(1, -1), (4, 0), (1, 1), (2, 0), (0, 0), (2, 2), (2, -2), (3, 1), (3, -1)];
g = unit_disk_graph(locs, 1.5)
show_graph(g; locs = locs, vertex_colors = [&quot;white&quot; for i in 1:nv(g)])</code></pre><p><img src="../main-6.svg" alt/></p><p>We then assign random weights to each vertex for this example problem:</p><pre><code class="language-julia hljs">weights = [rand() for i in 1:nv(g)];</code></pre><p>We can solve the MWIS problem classically for this graph using the <a href="https://github.com/QuEraComputing/GenericTensorNetworks.jl">GenericTensorNetworks</a> package. The MWIS is shown in red.</p><pre><code class="language-julia hljs">configs_mapped = GenericTensorNetworks.solve(IndependentSet(g; weights = weights), ConfigsMax())[]
MIS_config = configs_mapped.c[1]
show_graph(g; locs = locs, vertex_colors = [iszero(MIS_config[i]) ? &quot;white&quot; : &quot;red&quot; for i in 1:nv(g)])</code></pre><p><img src="../main-10.svg" alt/></p><h1 id="Quantum-Adiabatic-Algorithm-to-Solve-the-MWIS-Problem"><a class="docs-heading-anchor" href="#Quantum-Adiabatic-Algorithm-to-Solve-the-MWIS-Problem">Quantum Adiabatic Algorithm to Solve the MWIS Problem</a><a id="Quantum-Adiabatic-Algorithm-to-Solve-the-MWIS-Problem-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Adiabatic-Algorithm-to-Solve-the-MWIS-Problem" title="Permalink"></a></h1><p>The quantum adiabatic algorithm (QAA) can be performed with the Hamiltonian:</p><p class="math-container">\[H_{\text{QA}}(t) = \sum_{v \in V} (- \Delta_v(t) n_v + \frac{\Omega_v(t)}{2} \sigma_v^x) + \sum_{(u, w) \in E} U_{u,w} n_u n_w\]</p><p>Here, we work in the limit of <span>$\Delta, \Omega \ll U$</span>, where the non-independent set space of the graph can be neglected (on neutral-atom quantum hardware, this corresponds to the limit where the interaction energy is much stronger than other energy scales). In this limit, we can restrict ourselves to the Rydberg blockade subspace (see the <a href="../../1.blockade/main/#blockade">Rydberg Blockade</a> tutorial) of the graph and ignore the interaction term <span>$\sum_{(u, w) \in E} U n_u n_w$</span> in the Hamiltonian. Note that in this tutorial, we also do not include the long-range interaction tail in the Hamiltonian. The vertex weights of the MWIS problem in this Hamiltonian can be implemented on the hardware with individual atom detunings (specifying <span>$\Delta_v(t)$</span> for each atom).</p><p>The QAA can be designed by first initializing all qubits to the ground state of <span>$H_{\text{QA}}(t = 0)$</span> where <span>$\Delta(t = 0) = -\Delta_0 &lt; 0 $ and $\Omega(t = 0) = 0$</span>; the many-body ground state is basically with all atoms in the ground state <span>$| g \rangle$</span>. We then change the parameters by turning up <span>$\Omega(t)$</span> to a finite value and then to 0, and sweeping <span>$\Delta(t)$</span> to <span>$\Delta_0 &gt; 0$</span> after some final time <span>$t_f$</span>.</p><p>By the adiabatic theorem, when the time evolution is sufficiently slow, the system should follow the instantaneous ground state and end up in the solution to the MWIS problem.</p><h2 id="Building-Pulse-Sequences"><a class="docs-heading-anchor" href="#Building-Pulse-Sequences">Building Pulse Sequences</a><a id="Building-Pulse-Sequences-1"></a><a class="docs-heading-anchor-permalink" href="#Building-Pulse-Sequences" title="Permalink"></a></h2><p>Since we are considering the MWIS problem, we can implement individual atom detuning with <span>$\Delta(t)_i = w_i \times \Delta(t)$</span>.</p><p>Let&#39;s first build and plot the individual pulse waveforms. We use the following function to build the Hamiltonian and the corresponding waveforms for the adiabatic evolution of the system:</p><pre><code class="language-julia hljs">function build_adiabatic_sweep(graph, Ω_max::Float64, Δ_max::Float64, t_max::Float64, weights::Vector{Float64})
    Ω = Waveform(t -&gt; Ω_max * sin(pi * t / t_max)^2, duration = t_max)
    Δ = map(1:nv(graph)) do idx
        return Waveform(t -&gt; weights[idx] * Δ_max * (2 * t / t_max - 1), duration = t_max)
    end
    h = SumOfX(nv(graph), Ω) / 2 - SumOfN(nv(graph), Δ)
    return h, Ω, Δ
end</code></pre><pre><code class="nohighlight hljs">build_adiabatic_sweep (generic function with 1 method)</code></pre><p>Here, we choose <span>$\Delta_{\max} / \Omega_{\max} = 3$</span>, with <span>$\Omega_{\max} = 2 \pi \times 4$</span> MHz:</p><pre><code class="language-julia hljs">Ω_max = 2π * 4
Δ_max = 3 * Ω_max
t_max = 1.5
H, Ω, Δ = build_adiabatic_sweep(g, Ω_max, Δ_max, t_max, weights);

fig, (ax1, ax2) = plt.subplots(ncols = 2, figsize = (14, 4))
Bloqade.plot!(ax1, Ω)
ax1.set_ylabel(&quot;Ω/2π (MHz)&quot;)
for i in 1:nv(g)
    Bloqade.plot!(ax2, Δ[i])
end
ax2.set_ylabel(&quot;Δ/2π (MHz)&quot;)
fig</code></pre><p><img src="../main-21.svg" alt/></p><h2 id="Compute-the-MIS-Probability-and-the-Adiabatic-Timescale"><a class="docs-heading-anchor" href="#Compute-the-MIS-Probability-and-the-Adiabatic-Timescale">Compute the MIS Probability and the Adiabatic Timescale</a><a id="Compute-the-MIS-Probability-and-the-Adiabatic-Timescale-1"></a><a class="docs-heading-anchor-permalink" href="#Compute-the-MIS-Probability-and-the-Adiabatic-Timescale" title="Permalink"></a></h2><p>Here we compute the MWIS probability of the graph as a function of time. In addition, we would like to extract the adiabatic timescale <span>$T_{\text{LZ}}$</span> from the Landau-Zener fitting: <span>$1 - P_{\text{MWIS}} = e^{a - T/T_{\text{LZ}}}$</span>. To do this, we find the first instance time <span>$T^*$</span> such that <span>$P_{\text{MWIS}}(T) &gt; 0.9$</span>, and then continue to run evolutions to <span>$2.5T^*$</span> to extract <span>$T_{\text{LZ}}$</span>. See <a href="https://arxiv.org/pdf/1808.10816.pdf">H. Pichler et al. (10.48550/arXiv.1808.10816)</a> for more details on the procedure to extract the Landau-Zener timescale.</p><p>We run the simulation in the blockade (independent set) subspace:</p><pre><code class="language-julia hljs">t_list = []
P_MWIS = [] # MIS probability
subspace = independent_set_subspace(g);

total_time = 1.5
for t in 0.1:total_time*0.25:total_time*2.5
    h = build_adiabatic_sweep(g, Ω_max, Δ_max, t, weights)[1]
    r = zero_state(subspace)
    prob = SchrodingerProblem(r, t, h)
    emulate!(prob)
    p = config_probability(prob.reg, g, BitVector(MIS_config))

    push!(t_list, t)
    push!(P_MWIS, p)
end</code></pre><p>We can compute the adiabatic timescale by fitting a Landau-Zener curve to the MIS probability:</p><pre><code class="language-julia hljs">using CurveFit
y = broadcast(log, 1 .- P_MWIS[P_MWIS.&gt;0.9])
a, b = linear_fit(t_list[P_MWIS.&gt;0.9], y)
T_LZ = -1 / b;</code></pre><p>Finally, we plot the results:</p><pre><code class="language-julia hljs">fig, (ax1, ax2) = plt.subplots(ncols = 2, figsize = (16, 6))
ax1.scatter(t_list, P_MWIS)
ax1.set_ylabel(&quot;MWIS Probability&quot;)
ax1.set_xlabel(&quot;Time (μs)&quot;)

ax2.scatter(t_list, broadcast(log, 1 .- P_MWIS))
ax2.plot(t_list, a .+ b .* t_list)
ax2.set_xlabel(&quot;Time (μs)&quot;)
ax2.set_ylabel(&quot;log(1 - MWIS Probability)&quot;)

fig</code></pre><p><img src="../main-29.svg" alt/></p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../5.MIS/main/">« The Maximum Independent Set Problem</a><a class="docs-footer-nextpage" href="../../7.QMC/main/">Quantum Monte Carlo Method »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 20 June 2023 20:03">Tuesday 20 June 2023</span>. Using Julia version 1.9.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
